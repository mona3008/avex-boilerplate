{%- render 'stylesheet', name: 'product' -%}
<script src="{{ 'product-js.min.js' | asset_url }}" defer="defer"></script>

{%- assign current_variant = product.selected_or_first_available_variant -%}

<div class="product">
  {%- render 'breadcrumbs' -%}
    <div class="container-max product-container">
        <div is="product-image-gallery" class="product__gallery">
            <div class="swiper-container product-thumbnails" data-thumbnail-images>
                <div class="swiper-wrapper">
                    {%- for media in product.media -%}
                    <div class="swiper-slide product-thumbnails__item" data-thumbnail-item>
                        {% if media.media_type == 'video' %}
                          {%- render 'image', image: media.preview_image -%}
                        <span class="video-play">{%- render 'icon-play' -%}</span>
                        {% else %}
                          {%- render 'image', image: media -%}
                        {% endif %}
                    </div>
                {%- endfor -%}
                </div>
            </div>
            <div class="swiper-container product-images" data-main-images>
                <div class="swiper-wrapper">
                    {%- for media in product.media -%}
                    <div class="swiper-slide product-images__item">
                        {% if media.media_type == 'video' %}
                          {%- render 'image', image: media.preview_image -%}
                            <span class="video-play" data-videosrc="{{ media.sources[1].url }}" data-videotype="{{ media.sources[1].mime_type }}">{%- render 'icon-play' -%}</span>
                        {% else %}
                            <div class="swiper-zoom-container">
                                <figure class="zoom lazyload" data-zoomimg="{{ media.src | img_url: 'x2024' }}">
                                  {% if forloop.first == true %}
                                  {% assign lazyload = true %}
                                  {% else %}
                                  {% assign lazyload = false %}
                                  {% endif %}

                                  {%- render 'image', image: media, notLazy: lazyload, imageSizes: "(min-width: 540px) 100vw, 40vw" -%}
                                </figure>
                            </div>
                        {% endif %}
                    </div>
                {%- endfor -%}
                </div>
                {%- if product.media.size > 1 -%}
                    <div class="swiper-button-next swiper-button" aria-label="{{ 'accessibility.previous_slide' | t }}">{%- render 'icon-carousel-arrow' -%}</div>
                    <div class="swiper-button-prev swiper-button" aria-label="{{ 'accessibility.next_slide' | t }}">{%- render 'icon-carousel-arrow' -%}</div>
                    <div class="swiper-pagination"></div>
                {%- endif -%}
            </div>
          </div>
       
        <div class="product__details">
            <div class="product-details">
              {%- form 'product', product, class: 'form', id: "product-form", novalidate: 'novalidate', data-type: 'add-to-cart-form' -%}
                {%- for block in section.blocks -%}
                  {%- case block.type -%}
                  {%- when '@app' -%}
                    {% render block %}
                  {%- when 'title' -%}
                    <h1 class="product-details__title h3">{{ product.title }}</h1>
                  {%- when 'price' -%}
                    <div class="product-details__price" data-price>
                      <span class="price {% if current_variant.compare_at_price %}sale-price{% endif %}">{{ current_variant.price | money_without_trailing_zeros }}</span>
                      {% if current_variant.compare_at_price > 0 and block.settings.compare_price %}
                      <span class="compare-at-price">{{ current_variant.compare_at_price | money_without_trailing_zeros }}</span>
                      {% endif %}
                    </div>
                  {%- when 'payment_terms' -%}
                    <div class="product-details__shopPay-terms">
                      {{ form | payment_terms }}
                    </div>
                  {%- when 'variant_picker' -%}
                    {%- unless product.has_only_default_variant -%}
                      {%- if block.settings.picker_type == 'button' -%}
                        <variant-radios class="variant-button" data-section="{{ section.id }}" data-url="{{ product.url }}" {{ block.shopify_attributes }}>
                          {%- for option in product.options_with_values -%}
                              <fieldset class="variant-button__wrapper">
                                <legend class="variant-button__label">{{ option.name }}</legend>
                                {%- for value in option.values -%}
                                  <input type="radio" id="{{ section.id }}-{{ option.name }}-{{ forloop.index0 }}"
                                        name="{{ option.name }}"
                                        value="{{ value | escape }}"
                                        {% if option.selected_value == value %}checked{% endif %}
                                  >
                                  <label for="{{ section.id }}-{{ option.name }}-{{ forloop.index0 }}">
                                    {{ value }}
                                  </label>
                                {%- endfor -%}
                              </fieldset>
                          {%- endfor -%}
                          <script type="application/json">
                            {{ product.variants | json }}
                          </script>
                        </variant-radios>
                      {%- else -%}
                        <variant-selects class="variant-dropdown" data-section="{{ section.id }}" data-url="{{ product.url }}" {{ block.shopify_attributes }}>
                          {%- for option in product.options_with_values -%}
                            <div class="variant-dropdown__wrapper">
                              <label class="variant-dropdown__label" for="Option-{{ section.id }}-{{ forloop.index0 }}">
                                {{ option.name }}
                              </label>
                              <div class="select">
                                <select id="Option-{{ section.id }}-{{ forloop.index0 }}"
                                  class="select__select"
                                  name="options[{{ option.name | escape }}]"
                                >
                                  {%- for value in option.values -%}
                                    <option value="{{ value | escape }}" {% if option.selected_value == value %}selected="selected"{% endif %}>
                                      {{ value }}
                                    </option>
                                  {%- endfor -%}
                                </select>
                                <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-caret" viewBox="0 0 10 6">
                                  <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor">
                                </path></svg>
                              </div>
                            </div>
                          {%- endfor -%}
        
                          <script type="application/json">
                            {{ product.variants | json }}
                          </script>
                        </variant-selects>
                      {%- endif -%}
                    {%- endunless -%}
      
                    <noscript class="product-form__noscript-wrapper-{{ section.id }}">
                      <div class="product-form__input{% if product.has_only_default_variant %} hidden{% endif %}">
                        <label class="form__label" for="Variants-{{ section.id }}">Variants</label>
                        <div class="select">
                          <select name="id" id="Variants-{{ section.id }}" class="select__select" form="product-form" >
                            {%- for variant in product.variants -%}
                              <option
                                {% if variant == product.selected_or_first_available_variant %}selected="selected"{% endif %}
                                {% if variant.available == false %}disabled{% endif %}
                                value="{{ variant.id }}"
                              >
                                {{ variant.title }}
                                {%- if variant.available == false %} - Sold out{% endif %}
                                - {{ variant.price | money | strip_html }}
                              </option>
                            {%- endfor -%}
                          </select>
                        </div>
                      </div>
                    </noscript>
                  {%- when 'quantity_selector' -%}
                    <div class="product-details__quantityblock">
                        <p class="quantity__title">Quantity</p>
                        <quantity-input class="quantity">
                          <button class="quantity__button no-js-hidden" name="minus" type="button">
                            <span class="visually-hidden">Decrease</span>
                            &#8212;
                          </button>
                          <input class="quantity__input"
                              type="number"
                              name="quantity"
                              id="Quantity-{{ section.id }}"
                              min="1"
                              value="1"
                              aria-label="{{ 'products.product.quantity.input_label' | t: product: item.product.title | escape }}"
                            >
                          <button class="quantity__button no-js-hidden" name="plus" type="button">
                            <span class="visually-hidden">Increase</span>
                            &#43;
                          </button>
                        </quantity-input>
                    </div>
                  {%- when 'buy_buttons' -%}
                    <product-form class="product-form">
                      <div class="product-form__error-message-wrapper" role="alert">
                        <span class="product-form__error-message" data-ajax-cart-form-error></span>
                      </div>
      
                    
                        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                        <div class="product-form__buttons">
                          <button
                            id="AddToCart"
                            type="submit"
                            name="add"
                            class="product-form__submit primary-button"
                          {% if product.selected_or_first_available_variant.available == false %}disabled{% endif %}
                          >
                              {%- if product.selected_or_first_available_variant.available -%}
                                Add to cart
                              {%- else -%}
                                Sold out
                              {%- endif -%}
                          </button>
                          {%- if block.settings.show_dynamic_checkout -%}
                            {{ form | payment_button }}
                          {%- endif -%}
                        </div>
                    
                    </product-form>
                  {%- when 'description' -%}
                  <div class="product-details__description">
                    {{ product.description }}
                  </div>
                  {%- endcase -%}

                {%- endfor -%}

                <script type="application/json" data-bis-variants>{{ product.variants | json }}</script>
              {%- endform -%}

              {% assign accordion_items = section.blocks | where: "type", "collapsible_tab" %}
              <accordion-block  class="product-details__description" data-allow-multiple-open data-first-open>
                <ul class="accordion">
                    {%- for item in accordion_items -%}
                    <li class="accordion__item">
                        <button data-accordion="trigger" class="accordion__trigger">
                          {{ item.settings.heading | default: item.settings.page.title }}
                        </button>
                        <div data-accordion="content-container">
                            <div data-accordion="content" class="accordion__content">
                              {{ item.settings.content }}
                              {{ item.settings.page.content }}
                            </div>
                        </div>
                    </li>
                    {%- endfor -%}
                  </ul>
              </accordion-block>

            </div>        
        </div>
    </div>
</div>


<!-- Structured Data -->
{% render 'product-structured-data' %}
{% comment %}theme-check-disable{% endcomment %}
<script type="text/javascript">
  var _learnq = _learnq || [];

  var item = {
    Name: {{ product.title | json }},
    ProductID: {{ product.id | json }},
    Categories: {{ product.collections | map:'title' | json }},
    ImageURL: "https:{{ product.featured_image.src | img_url:'grande' }}",
    URL: "{{ shop.secure_url }}{{ product.url }}",
    Brand: {{ product.vendor | json }},
    Price: {{ product.price | money | json }},
    CompareAtPrice: {{ product.compare_at_price_max | money | json }}
  };

  _learnq.push(['track', 'Viewed Product', item]);
  _learnq.push(['trackViewedItem', {
    Title: item.Name,
    ItemId: item.ProductID,
    Categories: item.Categories,
    ImageUrl: item.ImageURL,
    Url: item.URL,
    Metadata: {
      Brand: item.Brand,
      Price: item.Price,
      CompareAtPrice: item.CompareAtPrice
    }
  }]);
</script>
{% comment %}theme-check-enable{% endcomment %}
{% schema %}
{
  "name": "Product page",
  "tag": "section",
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "default": "Text block",
          "label": "Text"
        }
      ]
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "payment_terms",
      "name": "Payment terms",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "compare_price",
          "label": "Show compare price?",
          "default": true
        }
      ]
    },
    {
      "type": "quantity_selector",
      "name": "Quantity selector",
      "limit": 1
    },
    {
      "type": "variant_picker",
      "name": "Variant Picker",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "picker_type",
          "options": [
            {
              "value": "dropdown",
              "label": "Dropdown"
            },
            {
              "value": "button",
              "label": "Buttons"
            }
          ],
          "default": "button",
          "label": "Variant Picker"
        }
      ]
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "default": true,
          "label": "Show dynamic checkout buttons"
        }
      ]
    },
    {
      "type": "description",
      "name": "Product description",
      "limit": 1
    },
    {
      "type": "collapsible_tab",
      "name": "Accordion",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "default": "Accordion Title",
          "label": "Title"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Text"
        },
        {
          "type": "page",
          "id": "page",
          "label": "Page"
        },
        {
          "type": "checkbox",
          "id": "isOpen",
          "label": "Is open"
        }
      ]
    }
  ],
  "settings": [
   
  ]
}
{% endschema %}