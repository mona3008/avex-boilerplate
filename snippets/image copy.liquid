{%- if image -%}
    {%- liquid 
        assign image_widths = '180,360,540,720,900,1080,1296,1512,1728,1944,2160,2376,2592,2808,3024' | split: ',' 
        assign srcSet = ''

    for width in image_widths
        assign width_num = width | plus: 0 | round

        if image.width >= width_num
        assign xWidth = width | append: 'x'
        assign imageUrl = image | img_url: xWidth | append: ' ' | append: width | append: 'w'
        assign srcSet = srcSet | append: imageUrl | append: ', '
        endif
    
    endfor 
    assign imgMaster = image.width | append: 'x'
    assign imgMasterUrl = image | img_url: imgMaster 
    assign srcSet = srcSet | append: imgMasterUrl | append: ' ' | append: image.width | append: 'w'

    assign isLazy = ''
    assign imgOrgUrl = image | img_url: '1400x'
    unless isNative 
        assign isLazy = 'lazyload'
        assign imgOrgUrl = image | img_url: '20x'
    endunless
    
    -%}

    
<picture>
    <img 
        class="{{ imageClass }} {{isLazy}}" 
        loading="lazy" 
        width="{{ image.width }}" 
        height="{{ image.height }}" 
        src="{{ imgOrgUrl }}" 
        {%- unless isNative -%}
            srcset="{{ srcSet }}" 
            sizes="auto"
        {% else %}
            data-srcset="{{ srcSet }}" 
            data-sizes="auto"
        {% endunless%}
        alt="{{ image.alt }}"/>
    </picture>
{%- endif -%}